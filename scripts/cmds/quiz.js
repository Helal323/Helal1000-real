const fs = require("fs");

const quizList = [
  { question: "ЁЯЗзЁЯЗй ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЬрж╛рждрзАржпрж╝ ржлрзБрж▓ ржХрзА?", options: ["A  рж╢рж╛ржкрж▓рж╛", "B  ржЧрзЛрж▓рж╛ржк", "C  ржХрж╛ржаржЧрзЛрж▓рж╛ржк", "D  ржЬржмрж╛ ржлрзБрж▓"], answer: "рж╢рж╛ржкрж▓рж╛" },
  { question: "ЁЯМ╕ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЬрж╛рждрзАржпрж╝ ржлрж▓ ржХрзА?", options: ["A  ржХрж╛ржБржарж╛рж▓", "B  ржЖржо", "C  рж▓рж┐ржЪрзБ", "D  ржХрж▓рж╛"], answer: "ржХрж╛ржБржарж╛рж▓" },
  { question: "ЁЯРЕ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЬрж╛рждрзАржпрж╝ ржкрж╢рзБ ржХрзА?", options: ["A  рж░ржпрж╝рзЗрж▓ ржмрзЗржЩрзНржЧрж▓ ржЯрж╛ржЗржЧрж╛рж░", "B  ржЧрж░рзБ", "C  ржЫрж╛ржЧрж▓", "D  рж╣рж╛рждрж┐"], answer: "рж░ржпрж╝рзЗрж▓ ржмрзЗржЩрзНржЧрж▓ ржЯрж╛ржЗржЧрж╛рж░" },
  { question: "ЁЯХКя╕П ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЬрж╛рждрзАржпрж╝ ржкрж╛ржЦрж┐ ржХрзА?", options: ["A  ржжрзЛржпрж╝рзЗрж▓", "B  ржкрж╛ржпрж╝рж░рж╛", "C  ржХрж╛ржХ", "D  ржЪржбрж╝рзБржЗ"], answer: "ржжрзЛржпрж╝рзЗрж▓" },
  { question: "ЁЯПЩя╕П ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж░рж╛ржЬржзрж╛ржирзА ржХрзЛржерж╛ржпрж╝?", options: ["A  ржврж╛ржХрж╛", "B  ржЪржЯрзНржЯржЧрзНрж░рж╛ржо", "C  ржЦрзБрж▓ржирж╛", "D  рж╕рж┐рж▓рзЗржЯ"], answer: "ржврж╛ржХрж╛" },
  { question: "ЁЯУЕ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕рзНржмрж╛ржзрзАржирждрж╛ ржжрж┐ржмрж╕ ржХржмрзЗ?", options: ["A  рзирзм ржорж╛рж░рзНржЪ", "B  рззрзм ржбрж┐рж╕рзЗржорзНржмрж░", "C  рзирзз ржлрзЗржмрзНрж░рзБржпрж╝рж╛рж░рж┐", "D  рзз ржЬрж╛ржирзБржпрж╝рж╛рж░рж┐"], answer: "рзирзм ржорж╛рж░рзНржЪ" },
  { question: "ЁЯОЦя╕П ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржмрж┐ржЬржпрж╝ ржжрж┐ржмрж╕ ржХржмрзЗ?", options: ["A  рззрзм ржбрж┐рж╕рзЗржорзНржмрж░", "B  рзирзм ржорж╛рж░рзНржЪ", "C  рзирзз ржлрзЗржмрзНрж░рзБржпрж╝рж╛рж░рж┐", "D  рззрзл ржЖржЧрж╕рзНржЯ"], answer: "рззрзм ржбрж┐рж╕рзЗржорзНржмрж░" },
  { question: "ЁЯПЮя╕П ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕ржмржЪрзЗржпрж╝рзЗ ржмржбрж╝ ржЬрзЗрж▓рж╛ ржХрзЛржиржЯрж┐?", options: ["A  рж░рж╛ржЩрзНржЧрж╛ржорж╛ржЯрж┐", "B  ржжрж┐ржирж╛ржЬржкрзБрж░", "C  ржЦрзБрж▓ржирж╛", "D  ржмрж░рж┐рж╢рж╛рж▓"], answer: "рж░рж╛ржЩрзНржЧрж╛ржорж╛ржЯрж┐" },
  { question: "ЁЯМК ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕ржмржЪрзЗржпрж╝рзЗ ржмржбрж╝ ржиржжрзА ржХрзЛржиржЯрж┐?", options: ["A  ржкржжрзНржорж╛", "B  ржпржорзБржирж╛", "C  ржорзЗржШржирж╛", "D  рждрж┐рж╕рзНрждрж╛"], answer: "ржкржжрзНржорж╛" },
  { question: "тЪ╜ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЬрж╛рждрзАржпрж╝ ржЦрзЗрж▓рж╛ ржХрзА?", options: ["A  рж╣рж╛ржбрзБржбрзБ", "B  ржХрзНрж░рж┐ржХрзЗржЯ", "C  ржлрзБржЯржмрж▓", "D  ржнрж▓рж┐ржмрж▓"], answer: "рж╣рж╛ржбрзБржбрзБ" }
];

const activeQuiz = {}; // store per-thread quiz

module.exports = {
  config: {
    name: "quiz",
    aliases: ["question", "exam"],
    version: "4.0",
    author: "Helal + GPT-5",
    countDown: 3,
    role: 0,
    category: "fun",
    shortDescription: { en: "ржмрж╛ржВрж▓рж╛ ржХрзБржЗржЬ ржЦрзЗрж▓рзЛ ржЖрж░ ржЙрждрзНрждрж░ ржжрж╛ржУ!" }
  },

  onStart: async function ({ message, event }) {
    const random = quizList[Math.floor(Math.random() * quizList.length)];

    const quizText = [
      "ЁЯза ржХрзБржЗржЬ ржЯрж╛ржЗржо!",
      "",
      `${random.question}`,
      "",
      ...random.options,
      "",
      "ЁЯСЙ ржЙрждрзНрждрж░ ржжрж┐рждрзЗ ржПржЗ ржорзЗрж╕рзЗржЬрзЗрж░ рж░рж┐ржкрзНрж▓рж╛ржЗ ржХрж░рзЛред"
    ].join("\n");

    const sent = await message.reply({ body: quizText });

    // ржкрзНрж░рждрж┐ржЯрж╛ ржерзНрж░рзЗржбрзЗрж░ ржЬржирзНржп ржХрзБржЗржЬ рж╕рзЗржн ржХрж░рзЗ рж░рж╛ржЦржмрзЗ
    activeQuiz[sent.messageID] = {
      answer: random.answer,
      threadID: event.threadID
    };
  },

  onEvent: async function ({ message, event }) {
    if (!event.messageReply) return;
    const quiz = activeQuiz[event.messageReply.messageID];
    if (!quiz) return;

    const userAnswer = event.body.trim().toLowerCase();
    const correct = quiz.answer.toLowerCase();

    if (userAnswer.includes(correct)) {
      await message.reply("ЁЯОЙ тЬЕ ржЕржнрж┐ржиржирзНржжржи! рждрзЛржорж╛рж░ ржЙрждрзНрждрж░ рж╕ржарж┐ржХ!\n\nЁЯМЯ рж╕ржарж┐ржХ ржЙрждрзНрждрж░ тЮЬ " + quiz.answer);
    } else {
      await message.reply("тЭМ ржнрзБрж▓ ржЙрждрзНрждрж░!\n\nЁЯУШ рж╕ржарж┐ржХ ржЙрждрзНрждрж░ рж╣рж▓рзЛ тЮЬ тЬи " + quiz.answer + " тЬи");
    }

    // ржЙрждрзНрждрж░ ржжрзЗржУрзЯрж╛рж░ ржкрж░ ржХрзБржЗржЬ ржорзБржЫрзЗ ржлрзЗрж▓ржмрзЗ ржпрж╛рждрзЗ ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржирж╛ рж╣рзЯ
    delete activeQuiz[event.messageReply.messageID];
  }
};
